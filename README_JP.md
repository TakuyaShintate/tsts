<div align="center">
  <img src="img/tsts-logo.png" width="600"/>
</div>

---

[![pypi](https://img.shields.io/pypi/v/tsts?style=flat)](https://pypi.org/project/tsts/1.1.0/)[![license](https://img.shields.io/github/license/TakuyaShintate/tsts?style=flat)](https://github.com/TakuyaShintate/tsts/blob/main/LICENSE)

<div align="center">
  <img src="img/result-example.png" width="1200"/>
</div>

[English](README.md)/æ—¥æœ¬èª

([ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³](https://takuyashintate.github.io/tsts/))

## â“ ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¤ã„ã¦

æœ€æ–°ã®æ™‚ç³»åˆ—äºˆæ¸¬æ‰‹æ³•ã‚’æä¾›ã™ã‚‹ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚

è‡ªå·±å›å¸°ï¼ˆARï¼‰ãƒ¢ãƒ‡ãƒ«ãªã©ã¨çµ„ã¿åˆã‚ã›ã¦ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹ãªã©ã€ã‚ˆã‚ŠæŸ”è»Ÿãªãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰ãŒå¯èƒ½ã§ã™ã€‚ã¾ãŸã€ãƒ¢ãƒ‡ãƒ«ã®ä»–ã«Data Augmentationã‚„æå¤±é–¢æ•°ã€ã‚ªãƒ—ãƒ†ã‚£ãƒã‚¤ã‚¶ãƒ¼ã«é–¢ã—ã¦ã‚‚æœ€æ–°ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚

## â› ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•

```
pip install tsts
```

ã¾ãŸã¯ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§é–‹ç™ºä¸­ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚

```
pip install git+https://github.com/takuyashintate/tsts
```

## âš¡ï¸ ã‚³ãƒ³ãƒ•ã‚£ã‚°ã‚µãƒ³ãƒ—ãƒ«

å„ãƒ¢ãƒ‡ãƒ«ã®ä½¿ç”¨ä¾‹ã«é–¢ã—ã¦ã¯ã€[ã‚µãƒ³ãƒ—ãƒ«](cfg)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ğŸš€ ä½¿ç”¨æ–¹æ³•

ã‚ã‚‹ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã§ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚’æ¸¬å®šã—ãŸã„å ´åˆãªã©ã€æ±ºã‚ã‚‰ã‚ŒãŸãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦äºˆæ¸¬ã‚’è¡Œã„ãŸã„å ´åˆã¯"`tools/train.py` & `tools/test.py`ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆ"ã‚’ã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§äºˆæ¸¬ã‚’è¡Œã„ãŸã„å ´åˆã¯"APIã‚’ä½¿ç”¨ã™ã‚‹å ´åˆ"ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### `tools/train.py` & `tools/test.py`ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆ

âœ… å°‘ãªã„ã‚³ãƒ¼ãƒ‰ã§å­¦ç¿’ & æ¨è«–ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™

#### 1. å­¦ç¿’ã«ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™

è¨“ç·´ãƒ‡ãƒ¼ã‚¿ï¼ˆCSVãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å„ã€…ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã—ã¦ãã ã•ã„ã€‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®åå‰ã¯ä»»æ„ã§ã™ã€‚è¨“ç·´ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãŒè¤‡æ•°å­˜åœ¨ã™ã‚‹å ´åˆã€ãã‚Œã‚‰ã‚’å…¨ã¦å„ã€…ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã—ã¦ãã ã•ã„ã€‚

#### 2. ã‚³ãƒ³ãƒ•ã‚£ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ

å­¦ç¿’æ™‚ã®è¨­å®šã‚’è¨˜è¿°ã—ãŸã‚³ãƒ³ãƒ•ã‚£ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚ãƒ¢ãƒ‡ãƒ«ã€Data Augmentationã€ã‚ªãƒ—ãƒ†ã‚£ãƒã‚¤ã‚¶ãƒ¼ã€å­¦ç¿’ç‡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼ãªã©ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚è¨­å®šå¯èƒ½ãªé …ç›®ã«ã¤ã„ã¦ã®è©³ç´°ã¯[ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³](https://takuyashintate.github.io/tsts/projects/config.html)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

ä»Šå›ã¯ç°¡å˜ã®ãŸã‚ã€æœ€å°é™ã®ã‚³ãƒ³ãƒ•ã‚£ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ä¸‹ã®å†…å®¹ã‚’`my_first_model.yml`ã¨ã—ã¦ä¿å­˜ã—ã¾ã™ã€‚[ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³](https://takuyashintate.github.io/tsts/)ã‹ã‚‰å¯¾è±¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ã“ã¨ã§åˆ¥ã®ãƒ¢ãƒ‡ãƒ«ã‚„æ‰‹æ³•ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚

```yaml
# `my_first_model.yml`ã¨ã—ã¦ä¿å­˜ã—ã¦ãã ã•ã„
LOGGER:
  LOG_DIR: "my-first-model"
```

#### 3. å­¦ç¿’

ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦å­¦ç¿’ã‚’å§‹ã‚ã¾ã™ã€‚ã„ã£ãŸã‚“å­¦ç¿’ãŒå§‹ã¾ã‚‹ã¨ã€2ã§æŒ‡å®šã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆ`my-first-model`ï¼‰ã«ãƒ¢ãƒ‡ãƒ«ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚„ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã¾ã™ã€‚ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯æå¤±å€¤ã‚„ãƒ¡ãƒˆãƒªãƒƒã‚¯ã®å€¤ãŒæ›¸ãè¾¼ã¾ã‚Œã¾ã™ã€‚

> ãƒ¢ãƒ‡ãƒ«ãªã©ã¨åŒæ§˜ã€æå¤±é–¢æ•°ã‚„ãƒ¡ãƒˆãƒªãƒƒã‚¯ã‚‚å¤‰æ›´å¯èƒ½ã§ã™

`--train-dir`ã¨`--valid-dir`ã«ã¯è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚`--in-feats`ã¨`--out-feats`ã«ã¯å…¥åŠ›å¤‰æ•°ã®åå‰ã®ãƒªã‚¹ãƒˆã¨å‡ºåŠ›å¤‰æ•°ã®åå‰ã®ãƒªã‚¹ãƒˆã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚

ã‚ã‚‹å‡ºåŠ›å¤‰æ•°ã«å¯¾ã—ã€å…¥åŠ›å¤‰æ•°ã¨åŒã˜æ™‚åˆ»ã®å€¤ã‚’äºˆæ¸¬ã—ãŸã„å ´åˆãŒã‚ã‚Šã¾ã™ï¼ˆæ™‚åˆ»t-n:tã®å…¥åŠ›å¤‰æ•°ã®å€¤ã«å¯¾ã—ã€æ™‚åˆ»t-n:tã®å‡ºåŠ›å¤‰æ•°ã®å€¤ã‚’äºˆæ¸¬ã—ãŸã„å ´åˆï¼‰ã€‚ãã†ã—ãŸå ´åˆã«ã¯`--lagging`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚

```
python tools/train.py \
    --cfg-name my_first_model.yml \
    --train-dir <dir to contain training data> \
    --valid-dir <dir to contain validation data> \
    --in-feats <list of input feature names> \
    --out-feats <list of output feature names>
```

#### 4. å­¦ç¿’å¾Œã®ãƒ¢ãƒ‡ãƒ«ã®ãƒ†ã‚¹ãƒˆ

å­¦ç¿’ãŒå®Œäº†ã—ãŸå¾Œã«ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã«å¯¾ã™ã‚‹äºˆæ¸¬çµæœã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚äºˆæ¸¬çµæœã¨æ­£è§£ãƒ©ãƒ™ãƒ«ã€ãã‚Œã‚‰ã®èª¤å·®ãŒè¨˜éŒ²ã•ã‚ŒãŸCSVãƒ•ã‚¡ã‚¤ãƒ«ã¨ãã‚Œã‚‰ãŒãƒ—ãƒ­ãƒƒãƒˆã•ã‚ŒãŸç”»åƒãŒ`--out-dir`ã§æŒ‡å®šã•ã‚ŒãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚å„ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦çµæœãŒä¿å­˜ã•ã‚Œã¾ã™ã€‚

```
python tools/test.py \
    --cfg-name my_first_model.yml \
    --train-dir <dir to contain training data> \
    --valid-dir <dir to contain validation data> \
    --test-dir <dir to contain test data> \
    --in-feats <list of input feature names> \
    --out-feats <list of output feature names> \
    --out-dir <result is saved in this directory>
```

### APIã‚’ä½¿ç”¨ã™ã‚‹å ´åˆ

âœ… æœªæ¥ã®å€¤ã‚’äºˆæ¸¬ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã¾ã™

#### 1~3. ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™ ~ å­¦ç¿’

`tools/train.py` & `tools/test.py`ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆ ã¨åŒæ§˜ã®æ‰‹é †ã§ã™ã€‚

#### 4. å­¦ç¿’å¾Œã®ãƒ¢ãƒ‡ãƒ«ã®ãƒ†ã‚¹ãƒˆ

å­¦ç¿’æ¸ˆã¿ã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ã¦ä»»æ„ã®å€¤ã§äºˆæ¸¬ã‚’è¡Œã„ã¾ã™ã€‚

> å…¥åŠ›å€¤ã¯ï¼ˆã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—æ•°, å¤‰æ•°ã®æ•°ï¼‰ã®å½¢ã‚’ã—ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™

```python
from tsts.apis import init_forecaster, run_forecaster
from tsts.utils import plot


(solver, X_scaler, y_scaler) = init_forecaster(
    cfg_name,  # config file (like "my_first_model.yml")
    train_dir,  # dir to contain training data
    in_feats,  # list of input feature names
    out_feats,  # list of output feature names
)
Z = run_forecaster(
    solver,
    X_scaler,
    y_scaler,
    X,  # torch.Tensor of (number of time steps, number of variables)
)
plot(Z)
```
