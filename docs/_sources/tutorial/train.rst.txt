=========================
Train (Sine/Cosine Curve)
=========================

In this tutorial, we will learn how to start training on a custom dataset.

Workflow
========

To start training, we have 3 steps:

1. (Optional) Make a config file
2. Prepare training datasets (validation dataset should be included in training dataset)
3. Run `fit` method

Let's go through step by step.

Configuration
=============

Training process can be configured by a custom config file. In the following config file, model and the number of hidden units are indicated.

.. code-block:: yaml

    # first-config.yml
    MODEL:
      NAME: "NBeats"
      NUM_H_UNITS: 512

To update global configuration with the custom config file, pass the custom config file path to `Forecaster`.

.. code-block:: python

    import torch
    from tsts.solvers import Forecaster

    sin_dataset = torch.sin(torch.arange(0, 100, 0.1))
    sin_dataset = sin_dataset.unsqueeze(-1)
    forecaster = Forecaster(cfg_path="first-config.yml")
    forecaster.fit([sin_dataset])

You can see how it was changed by `cfg` property.

.. code-block:: python

    print(forecaster.cfg)

.. code-block:: yaml
    :emphasize-lines: 3, 4

    MODEL:
      DEPTH: 2
      NAME: NBeats
      NUM_H_UNITS: 512
