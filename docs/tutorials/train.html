

<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Train &amp; Test on a Custom Dataset &mdash; tsts  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data Augmentation" href="../modules/dataaug.html" />
    <link rel="prev" title="How a Config File is Structured" href="../projects/config.html" /> 

</head>

<body>
    <header>
        <div class="container">
            <a class="site-nav-toggle hidden-lg-up"><i class="icon-menu"></i></a>
            <a class="site-title" href="../index.html">
                tsts
            </a>
        </div>
    </header>


<div class="breadcrumbs-outer hidden-xs-down">
    <div class="container">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="breadcrumbs">
    
      <li><a href="../index.html">Docs</a></li>
        
      <li>Train &amp; Test on a Custom Dataset</li>
    
    
      <li class="breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/train.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
</div>
    </div>
</div>
    <div class="main-outer">
        <div class="container">
            <div class="row">
                <div class="col-12 col-lg-3 site-nav">
                    
<div role="search">
    <form class="search" action="../search.html" method="get">
        <div class="icon-input">
            <input type="text" name="q" placeholder="Search" />
            <span class="icon-search"></span>
        </div>
        <input type="submit" value="Go" class="d-hidden" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div>
                    <div class="site-nav-tree">
                        
                            
                            
                                <p class="caption" role="heading"><span class="caption-text">üåè About Project</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../projects/config.html">How a Config File is Structured</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#general-settings">General Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#input-output">Input &amp; Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#training">Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#optimizer">Optimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#learning-rate-scheduler">Learning Rate Scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#trainer">Trainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#model">Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#local-scaler">Local Scaler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#loss-function">Loss Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#metric">Metric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#dataset">Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#pipeline">Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#scaler">Scaler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#dataloader">Dataloader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#logger">Logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/config.html#putting-it-together">Putting It Together</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">‚ö°Ô∏è Getting Started</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Train &amp; Test on a Custom Dataset</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#using-tools-train-py-tools-test-py">Using <cite>tools/train.py</cite> &amp; <cite>tools/test.py</cite></a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">üìó Catalog</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/dataaug.html">Data Augmentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/dataaug.html#gaussian-noise">Gaussian Noise</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/losses.html">Loss Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/losses.html#dilate">DILATE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/losses.html#mean-absolute-error-mae">Mean Absolute Error (MAE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/losses.html#mean-absolute-percentage-error-mape">Mean Absolute Percentage Error (MAPE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/losses.html#mean-squared-error-mse">Mean Squared Error (MSE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/losses.html#smooth-mae">Smooth MAE</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/models.html">Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/models.html#informer">Informer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/models.html#n-beats">N-BEATS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/models.html#scinet">SCINet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/models.html#seq2seq">Seq2Seq</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/optimizers.html">Optimizers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/optimizers.html#adam">Adam</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/optimizers.html#adamw">AdamW</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/optimizers.html#sam">SAM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/optimizers.html#sgd">SGD</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/scalers.html">Scalers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/scalers.html#identity-scaler">Identity Scaler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/scalers.html#min-max-scaler">Min-Max Scaler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/scalers.html#standard-scaler">Standard Scaler</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/schedulers.html">LR Schedulers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/schedulers.html#cosine-annealing">Cosine Annealing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/schedulers.html#cosine-annealing-warm-restarts">Cosine Annealing Warm Restarts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/schedulers.html#exponential-decay">Exponential Decay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/schedulers.html#identity">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/schedulers.html#step">Step</a></li>
</ul>
</li>
</ul>

                            
                        
                    </div>
                </div>
                <div class="col-12 col-lg-9">
                    <div class="document">
                        
                            
  <div class="section" id="train-test-on-a-custom-dataset">
<h1>Train &amp; Test on a Custom Dataset<a class="headerlink" href="#train-test-on-a-custom-dataset" title="Permalink to this headline">¬∂</a></h1>
<div class="section" id="using-tools-train-py-tools-test-py">
<h2>Using <cite>tools/train.py</cite> &amp; <cite>tools/test.py</cite><a class="headerlink" href="#using-tools-train-py-tools-test-py" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="preparation-of-data-to-be-used-for-training">
<h3>1. Preparation of data to be used for training<a class="headerlink" href="#preparation-of-data-to-be-used-for-training" title="Permalink to this headline">¬∂</a></h3>
<p>Save the training data (CSV files), validation data, and test data in their respective directories. The name of the directory is arbitrary. If there are multiple training, validation, and test data, please save them all in their respective directories.</p>
</div>
<div class="section" id="create-a-config-file">
<h3>2. Create a config file<a class="headerlink" href="#create-a-config-file" title="Permalink to this headline">¬∂</a></h3>
<p>Create a config file describing the settings during training. You can specify the model, Data Augmentation, Optimizer, Learning Rate Scheduler, etc.</p>
<p>For simplicity, we will use a minimal config file here. Save the following as <cite>my_first_model.yml</cite>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Save as `my_first_model.yml`</span>
<span class="nt">LOGGER</span><span class="p">:</span>
  <span class="nt">LOG_DIR</span><span class="p">:</span> <span class="s">&quot;my-first-model&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="training">
<h3>3. Training<a class="headerlink" href="#training" title="Permalink to this headline">¬∂</a></h3>
<p>Execute the command below to begin training. Once training begins, model parameters and a log file will be created in the directory specified in 2 (<cite>my-first-model</cite> here). The log file will contain loss and metric values for each epoch.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Loss functions and metrics can be changed as well as models</p>
</div>
<p>Specify the directory where the training and validation data are stored in <cite>‚Äìtrain-dir</cite> and <cite>‚Äìvalid-dir</cite>. Specify a list of input variable names and a list of output variable names in <cite>‚Äìin-feats</cite> and <cite>‚Äìout-feats</cite>.</p>
<p>Sometimes you may want to predict the value of an output variable at the same time as the input variable (i.e., you want to predict the value of an output variable at time t-n to t for the value of an input variable at time t-n to t). In such cases, add the <cite>‚Äìlagging</cite> option.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python tools/train.py <span class="se">\</span>
   --cfg-name my_first_model.yml <span class="se">\</span>
   --train-dir &lt;dir to contain training data&gt; <span class="se">\</span>
   --valid-dir &lt;dir to contain validation data&gt; <span class="se">\</span>
   --in-feats &lt;list of input feature names&gt; <span class="se">\</span>
   --out-feats &lt;list of output feature names&gt;
</pre></div>
</div>
</div>
<div class="section" id="testing-a-trained-model">
<h3>4. Testing a trained model<a class="headerlink" href="#testing-a-trained-model" title="Permalink to this headline">¬∂</a></h3>
<p>After training is complete, the command below can be executed to obtain the prediction results for the test data. CSV files containing the prediction results, the correct labels, and their errors will be saved in the directory specified by <cite>‚Äìout-dir</cite>, and images of them plotted. Results are saved for each test data.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python tools/test.py <span class="se">\</span>
   --cfg-name my_first_model.yml <span class="se">\</span>
   --train-dir &lt;dir to contain training data&gt; <span class="se">\</span>
   --valid-dir &lt;dir to contain validation data&gt; <span class="se">\</span>
   --test-dir &lt;dir to contain <span class="nb">test</span> data&gt; <span class="se">\</span>
   --in-feats &lt;list of input feature names&gt; <span class="se">\</span>
   --out-feats &lt;list of output feature names&gt; <span class="se">\</span>
   --out-dir &lt;result is saved in this directory&gt;
</pre></div>
</div>
</div>
</div>
</div>


                        
                    </div>
                </div>
            </div>
        </div>
    </div>    


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/clipboard.min.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  
    <div class="footer" role="contentinfo">
        <div class="container">
            &#169; Copyright 2021, tsts development team.
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.1.2.
        </div>
    </div>  

</body>
</html>